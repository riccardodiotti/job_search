<!DOCTYPE html>
<html>
<head>
  <title>Home</title>
  <style>
    body {
     background-image: url('image.jpg');
     background-repeat: no-repeat;
     background-size: cover;
    }
    h1 {
    text-align:center;
    color:  white;
    } 
    .loading {
      width: 35px;
      height: 35px;
      display: none;
      position: absolute,left 50%;
      background: url(https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExYnNiNjkxM3RmcjhjZmVzYzQzZjVhMDY0Y3NvYzVsODhqZ214M2JycSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3oEjI6SIIHBdRxXI40/giphy.gif) no-repeat;
      cursor: wait;
      }
      .loader {
      border: 16px solid #f3f3f3; /* Light grey */
      border-top: 16px solid #3498db; /* Blue */
      border-radius: 50%;
      position: fixed;
      top:0;
      left:0;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #f7f9fb;
      transition: opacity 0.75s, visibility 0.75s;
      animation: spin 2s linear infinite;
      }
      .loader-hidden {
        opacity:0;
        visibility: hidden;
      }
      .loader::after {
        content: "";
        width: 75px;
        height: 75px;
        border: 15px solid #dddddd;
        border-top-color: #7449f5;
        border-radius: 50%;
        animation: loading 0.75s ease infinite;
      }
      #Progress_Status {
          width: 50%;
          background-color: #ddd;
        }
        #myprogressBar {
          width: 2%;
          height: 20px;
          background-color: #4CAF50;
        }
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
@keyframes loading {
  from { transform: rotate(0turn); }
  to { transform: rotate(1turn); }
}

.PDloading {
  position: fixed;
  z-index: 999;
  overflow: show;
  margin: auto;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
}

.PDloading:before {
  content: '';
  display: block;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.3);
}

#PDloader {
  position: fixed;
  left: 50%;
  top: 50%;
  z-index: 1;
  margin: -40px 0 0 -40px;
  border: 10px solid #f3f3f3;
  border-radius: 50%;
  border-top: 10px solid #3498db;
  border-bottom: 10px solid #3498db;
  width: 80px;
  height: 80px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
}
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
    </style>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="/search.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.devbridge-autocomplete/1.2.26/jquery.autocomplete.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script>
    $(document).ready(function(){
    $('#sample_form').on('submit', function(event){
      event.preventDefault();
      var count_error = 0;
     
      if($('#job').val() == '')
      {
       $('#job_error').text('Job is required');
       count_error++;
      }
      else
      {
       $('#job_error').text('');
      }
     
      if($('#country').val() == '')
      {
       $('#country_error').text('Country is required');
       count_error++;
      }
      else
      {
       $('#country_error').text('');
      }
     
      if(count_error == 0)
      {
       $.ajax({
      url:"/ajaxprogressbar",
      method:"POST",
      data:$(this).serialize(),
      beforeSend:function()
      {
       $('#save').attr('disabled', 'disabled');
       $('#process').css('display', 'block');
      },
      success:function(data)
      { 
       var percentage = 0;
     
       var timer = setInterval(function(){
        percentage = percentage + 20;
        progress_bar_process(percentage, timer,data);
       }, 1000);
      }
     })
      }
      else
      {
       return false;
      }
        
     });
       
     function progress_bar_process(percentage, timer,data)
     {
    $('.progress-bar').css('width', percentage + '%');
    if(percentage > 100)
    {
     clearInterval(timer);
     $('#search_form')[0].reset();
     $('#process').css('display', 'none');
     $('.progress-bar').css('width', '0%');
     $('#save').attr('disabled', false);
     $('#success_message').html(data);
     setTimeout(function(){
      $('#success_message').html('');
     }, 5000);
    }
     }
       
    });
   </script>
</head>
<body>
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container">
      <a class="navbar-brand" href="/">Job Search</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/">Home</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <br/>
  <div
  class="bg-image"
  style="
    background-image: url('https://ese2240.seas.upenn.edu/wp-content/uploads/2018/11/background-website-light-blue-wallpapers-background-2.jpg');
    height: 100vh;
    background-size:100% 100%;
  ">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item active" aria-current="page"  color="white">Home</li>
    </ol>
  </nav>
  <div class="container align-items-center">
    <div class="panel-body" style="width:800px; margin:0 auto;">
      <div class="alert alert-warning alert-dismissible fade show" role="alert">
      {% with messages = get_flashed_messages() %}
        {% if messages %}
          {%for msg in messages %}
            <p>{{msg}}</p>
          {% endfor %}
        {% endif %}
       {% endwith %} 
      </div>
    </div>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/University_College%2C_University_of_Toronto%2C_Canada.jpg/800px-University_College%2C_University_of_Toronto%2C_Canada.jpg?20170921221540" width=1100 alt="University">
    <br/>
    <h1>Search for a job:</h1>
      <br/>
      <hr class="border border-primary border-3 opacity-75">
      <div class="form-group align-items-center" style="width:800px; margin:0 auto;">
        <form method="GET" id="search_form">
          {{form.hidden_tag()}}
          {{form.csrf_token}}
          {{form.job.label(class="form-label")}}
          {{form.job(class="form-control",size=3)}}
          <span id="job_error" class="text-danger"></span>
          <br/>
          <fieldset name="job-other">
            <div>
              {{ form.job_details.label() }}
              {{ form.job_details() }}
            </div>
          </fieldset>
      </div>
      <hr class="border border-primary border-3 opacity-75">
      <div class="form-group align-items-center" style="width:800px; margin:0 auto;">
        {{form.country.label(class="form-label")}}
        {{form.country(class="form-control",size=3)}}
        <span id="country_error" class="text-danger"></span>
        <br/>
        <fieldset name="country-other">
          <div>
            {{ form.country_details.label() }}
            {{ form.country_details() }}
          </div>
        </fieldset>
      </div>
      <div class="col-auto">
        <input id="submit" type="submit" value="Search" class="btn btn-primary btn-lg" style="width:800px; margin:0 auto;">
      </div>
      <img id="myspinner" src="https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExYnNiNjkxM3RmcjhjZmVzYzQzZjVhMDY0Y3NvYzVsODhqZ214M2JycSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3oEjI6SIIHBdRxXI40/giphy.gif" alt="Searching, please wait" style="display:none;"/>
      </form>
    </div>
  </div>

  <script>

document.getElementById('search_form').addEventListener('submit', function(event) {
    //event.preventDefault(); // Prevent the form from submitting the traditional way
    document.getElementById('myspinner').style.display = 'block'; // Show the spinner

    // Simulate an asynchronous GET request
    setTimeout(() => {
        document.getElementById('myspinner').style.display = 'none'; // Hide the spinner after the request is complete
        //this.submit(); // Submit the form the traditional way
    }, 120000); // Simulate a 2 second delay (remove or modify as needed)
});
    </script>
</body>
</html>